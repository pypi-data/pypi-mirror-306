"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2329],{60648:function(e,n,t){t.d(n,{Z:function(){return m}});var r=t(52322),s=t(43212),o=t(14934),i=t(55010),l=t(2784),a=t(90797),d=t(88257),c=t(54516),u=t(84046),x=t(59351),p=t(33182),h=t(88610);let m=(0,l.memo)(e=>{let{name:n,run:t,showHover:m=!1,showButton:j=!0,showSummary:f=!0}=e,{status:g}=t,b=(0,l.useMemo)(()=>{switch(g){case d.VOA.SUCCESS:return"success";case d.VOA.CANCELED:case d.VOA.CANCELING:case d.VOA.FAILURE:return"danger";default:return"none"}},[g]);return(0,r.jsxs)(o.x,{flex:{direction:"row",justifyContent:"space-between",alignItems:"flex-start",gap:16},children:[(0,r.jsxs)(o.x,{flex:{direction:"column",alignItems:"flex-start",gap:4},children:[(0,r.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:8},children:[(()=>{let e=(0,r.jsx)(s.V,{intent:b,children:(0,r.jsxs)(o.x,{flex:{direction:"row",alignItems:"center",gap:4},children:[(0,r.jsx)(c.K9,{status:t.status,size:10}),(0,r.jsx)(p.Zr,{run:t})]})});return m?(0,r.jsx)(i.J,{position:"top",interactionKind:"hover",content:(0,r.jsx)("div",{children:(0,r.jsx)(u.qL,{run:t,name:n})}),hoverOpenDelay:100,children:e}):e})(),f?(0,r.jsx)(p.Tw,{run:t}):null]}),f&&(x.hd.has(t.status)||x.Ys.has(t.status))?(0,r.jsx)(a.I,{runId:t.id}):void 0]}),j?(0,r.jsx)(h.A,{to:"/runs/".concat(t.id),children:"View run"}):null]})})},90797:function(e,n,t){t.d(n,{I:function(){return m}});var r=t(73235),s=t(52322),o=t(35292),i=t(39013),l=t(19126),a=t.n(l),d=t(2784),c=t(47933),u=t(20958),x=t(88257),p=t(59351);function h(){let e=(0,r._)(["\n  query StepSummaryForRunQuery($runId: ID!) {\n    pipelineRunOrError(runId: $runId) {\n      ... on Run {\n        id\n        status\n        stepStats {\n          endTime\n          stepKey\n          status\n        }\n      }\n    }\n  }\n"]);return h=function(){return e},e}let m=e=>{let{runId:n}=e,{data:t}=(0,u.aM)(j,{variables:{runId:n}}),r=null==t?void 0:t.pipelineRunOrError,l=(null==r?void 0:r.__typename)==="Run"?r.status:null,h=(0,d.useMemo)(()=>{if((null==r?void 0:r.__typename)!=="Run")return[];let{status:e}=r;return p.hd.has(e)?r.stepStats.filter(e=>e.status===x.SGm.FAILURE):p.Ys.has(e)?r.stepStats.filter(e=>e.status===x.SGm.IN_PROGRESS):[]},[r]),m=h.length;if(!m||!l)return null;if(p.hd.has(l)){if(1===m){let e=h[0],t=e.endTime?a().stringify({focusedTime:Math.floor(1e3*e.endTime)},{addQueryPrefix:!0}):"";return(0,s.jsxs)(o.YS,{color:i.$(),children:["Failed at ",(0,s.jsx)(c.rU,{to:"/runs/".concat(n).concat(t),children:e.stepKey})]})}return(0,s.jsxs)(o.YS,{color:i.$(),children:["Failed at ",(0,s.jsxs)(c.rU,{to:"/runs/".concat(n),children:[m," steps"]})]})}if(p.Ys.has(l)){if(1===m){let e=h[0],t=e.endTime?a().stringify({focusedTime:Math.floor(1e3*e.endTime)},{addQueryPrefix:!0}):"";return(0,s.jsxs)(o.YS,{color:i.$(),children:["In progress at ",(0,s.jsx)(c.rU,{to:"/runs/".concat(n).concat(t),children:e.stepKey})]})}return(0,s.jsxs)(o.YS,{color:i.$(),children:["In progress at ",(0,s.jsxs)(c.rU,{to:"/runs/".concat(n),children:[m," steps"]})]})}return null},j=(0,u.Ps)(h())},72329:function(e,n,t){t.r(n),t.d(n,{JobsRoot:function(){return eb},default:function(){return ey}});var r=t(52322),s=t(14934),o=t(74580),i=t(35292),l=t(55255),a=t(79106),d=t(39013),c=t(37483),u=t(45774),x=t(2784),p=t(44900),h=t(4378);let m=e=>{let[n,t]=(0,h.q)({encode:n=>e.reduce((e,t)=>{let r=n[t];return e[t]=(null==r?void 0:r.length)?JSON.stringify(r):void 0,e},{}),decode:n=>e.reduce((e,t)=>(e[t]=n[t]?JSON.parse(n[t]):[],e),{})}),r=(0,x.useMemo)(()=>{let n={};return e.forEach(e=>{n["set".concat(e.charAt(0).toUpperCase()+e.slice(1))]=n=>{t(t=>({...t,[e]:n instanceof Function?n(t[e]):n}))}}),n},[e,t]);return{state:n,setState:t,setters:r}};var j=t(90483),f=t(35002),g=t(43212),b=t(88510),y=t(22921),v=t(17008),w=t(98956),I=t(50646),S=t(73235),C=t(53664),E=t(47933),L=t(35505),N=t(83738),R=t(92199),A=t(10539),J=t(20958),P=t(16336),_=t(60603),O=t(55010),U=t(38491),M=t(36803),T=t(48764),k=t(51701),$=t(88257),q=t(83846),z=t(42519),F=t(43);function V(){let e=(0,S._)(["\n  query RunReExecutionQuery($runId: ID!) {\n    pipelineRunOrError(runId: $runId) {\n      ... on Run {\n        id\n        status\n        pipelineName\n        executionPlan {\n          artifactsPersisted\n          ...ExecutionPlanToGraphFragment\n        }\n      }\n    }\n  }\n  ","\n"]);return V=function(){return e},e}let Z=e=>{let{job:n,isAssetJob:t,repoAddress:s}=e,o=n.runs.length?n.runs[0]:null,i={pipelineName:n.name,repositoryName:s.name,repositoryLocationName:s.location},d=(0,T.DO)(n.name),c=(0,z.D)(),{permissions:{canLaunchPipelineReexecution:u,canLaunchPipelineExecution:p},disabledReasons:h}=(0,M.xz)(s.location),[m,j]=(0,J.td)(Y),{data:g}=j,b=(0,x.useCallback)(()=>{(null==o?void 0:o.id)&&m({variables:{runId:o.id}})},[o,m]),y=(null==g?void 0:g.pipelineRunOrError.__typename)==="Run"?null==g?void 0:g.pipelineRunOrError:null,v="loading"===t?(0,r.jsx)(_.sN,{icon:"execute",text:"Loading...",disabled:!0}):!0===t?(0,r.jsx)(_.sN,{icon:d.loading?(0,r.jsx)(a.$,{purpose:"caption-text"}):"execute",text:"Launch new run",disabled:!p,onClick:e=>d.onClick(i,e)}):(0,r.jsx)(F.U,{icon:"execute",text:"Launch new run",disabled:!p,to:(0,A.jT)({repoName:s.name,repoLocation:s.location,pipelineName:n.name,isJob:n.isJob,path:"/playground"})}),w=(0,r.jsx)(_.sN,{icon:"replay",text:"Re-execute latest run",onClick:()=>y?c(y,$.hmq.ALL_STEPS):void 0,disabled:!u||!y||!(0,q.EP)(y)}),I=(0,r.jsx)(_.sN,{icon:"sync_problem",text:"Re-execute latest run from failure",onClick:()=>y?c(y,$.hmq.FROM_FAILURE):void 0,disabled:!u||!y||!(0,q.VM)(y)});return(0,r.jsxs)(r.Fragment,{children:[d.launchpadElement,(0,r.jsx)(O.J,{onOpened:()=>b(),content:(0,r.jsxs)(_.v2,{children:[(0,r.jsx)(F.U,{to:(0,A.jT)({repoName:s.name,repoLocation:s.location,pipelineName:n.name,isJob:n.isJob}),icon:"job",text:"View job"}),(0,r.jsx)(F.U,{to:(0,A.jT)({repoName:s.name,repoLocation:s.location,pipelineName:n.name,isJob:n.isJob,path:"/runs"}),icon:"checklist",text:"View all recent runs"}),p?v:(0,r.jsx)(f.u,{content:h.canLaunchPipelineExecution,display:"block",children:v}),u?w:(0,r.jsx)(f.u,{content:h.canLaunchPipelineReexecution,display:"block",children:w}),u?I:(0,r.jsx)(f.u,{content:h.canLaunchPipelineReexecution,display:"block",children:I})]}),position:"bottom-left",children:(0,r.jsx)(U.zx,{icon:(0,r.jsx)(l.JO,{name:"expand_more"})})})]})},Y=(0,J.Ps)(V(),k.$);var Q=t(60648),D=t(74283),G=t(84046),K=t(33182),H=t(4219),W=t(60918);function X(){let e=(0,S._)(["\n  query SingleJobQuery($selector: PipelineSelector!) {\n    pipelineOrError(params: $selector) {\n      ... on Pipeline {\n        id\n        name\n        isJob\n        isAssetJob\n        description\n        runs(limit: 5) {\n          id\n          ...RunTimeFragment\n        }\n        schedules {\n          id\n          ...ScheduleSwitchFragment\n        }\n        sensors {\n          id\n          ...SensorSwitchFragment\n        }\n      }\n    }\n  }\n\n  ","\n  ","\n  ","\n"]);return X=function(){return e},e}let B="1.5fr 1fr 180px 96px 80px",ee=e=>{let{name:n,isJob:t,repoAddress:o,start:i,height:l}=e,[a,d]=(0,J.td)(es,{variables:{selector:(0,R._T)(o,n)}});(0,N.v5)(a),(0,P.C4)(d,P.dT);let{data:c}=d,u=(null==c?void 0:c.pipelineOrError.__typename)==="Pipeline"?null==c?void 0:c.pipelineOrError:void 0,{schedules:p,sensors:h}=(0,x.useMemo)(()=>{if(u){let{schedules:e,sensors:n}=u;return{schedules:e,sensors:n}}return{schedules:[],sensors:[]}},[u]),m=(0,x.useMemo)(()=>{if(u){let{runs:e}=u;if(e.length)return[...e]}return[]},[u]);return(0,r.jsx)(v.X2,{$height:l,$start:i,children:(0,r.jsxs)(et,{border:"bottom",children:[(0,r.jsxs)(v.E5,{children:[(0,r.jsx)("div",{style:{maxWidth:"100%",whiteSpace:"nowrap",fontWeight:500},children:(0,r.jsx)(E.rU,{to:(0,A.$U)(o,"/jobs/".concat(n)),children:(0,r.jsx)(C.g,{text:n})})}),(0,r.jsx)(N.HB,{children:(null==u?void 0:u.description)||""})]}),(0,r.jsx)(v.E5,{children:p.length||h.length?(0,r.jsx)(s.x,{flex:{direction:"column",alignItems:"flex-start",gap:8},children:(0,r.jsx)(er,{children:(0,r.jsx)(D.I,{schedules:p,sensors:h,repoAddress:o})})}):(0,r.jsx)(N.mq,{queryResult:d})}),(0,r.jsx)(v.E5,{children:m[0]?(0,r.jsx)(Q.Z,{run:m[0],showButton:!1,showHover:!0,showSummary:!1,name:n}):(0,r.jsx)(N.mq,{queryResult:d})}),(0,r.jsx)(v.E5,{children:m.length?(0,r.jsx)(s.x,{padding:{top:4},children:(0,r.jsx)(G.JH,{jobName:n,runs:[...m].reverse(),fade:!0})}):(0,r.jsx)(N.mq,{queryResult:d})}),(0,r.jsx)(v.E5,{children:(0,r.jsx)(s.x,{flex:{justifyContent:"flex-end"},style:{marginTop:"-2px"},children:(0,r.jsx)(Z,{job:{name:n,isJob:t,runs:m},isAssetJob:u?u.isAssetJob:"loading",repoAddress:o})})})]})})},en=()=>(0,r.jsxs)(v.VJ,{templateColumns:B,sticky:!0,children:[(0,r.jsx)(v.qN,{children:"Name"}),(0,r.jsx)(v.qN,{children:"Schedules/sensors"}),(0,r.jsx)(v.qN,{children:"Latest run"}),(0,r.jsx)(v.qN,{children:"Run history"}),(0,r.jsx)(v.qN,{})]}),et=(0,L.ZP)(s.x).withConfig({componentId:"sc-c1e02df2-0"})(["display:grid;grid-template-columns:",";height:100%;"],B),er=L.ZP.div.withConfig({componentId:"sc-c1e02df2-1"})(["width:100%;> .bp5-popover-target{width:100%;}"]),es=(0,J.Ps)(X(),K.$X,H.J,W.U);var eo=t(22563);let ei=e=>{let{repos:n}=e,t=(0,x.useRef)(null),s=(0,x.useMemo)(()=>n.map(e=>{let{repoAddress:n}=e;return(0,eo.Uz)(n)}),[n]),{expandedKeys:o,onToggle:i,onToggleAll:l}=(0,I.N)(y.y,s),a=(0,x.useMemo)(()=>{let e=[];return n.forEach(n=>{let{repoAddress:t,jobs:r}=n;e.push({type:"header",repoAddress:t,jobCount:r.length});let s=(0,eo.Uz)(t);o.includes(s)&&r.forEach(n=>{let{isJob:r,name:s}=n;e.push({type:"job",repoAddress:t,isJob:r,name:s})})}),e},[n,o]),d=(0,w.w)(n.map(e=>{let{repoAddress:n}=e;return n.name})),c=(0,b.MG)({count:a.length,getScrollElement:()=>t.current,estimateSize:e=>{let n=a[e];return(null==n?void 0:n.type)==="header"?v.lo:64},overscan:10}),u=c.getTotalSize(),p=c.getVirtualItems();return(0,r.jsx)("div",{style:{overflow:"hidden"},children:(0,r.jsxs)(v.W2,{ref:t,children:[(0,r.jsx)(en,{}),(0,r.jsx)(v.Nh,{$totalHeight:u,children:p.map(e=>{let{index:n,key:t,size:s,start:c}=e,u=a[n];return"header"===u.type?(0,r.jsx)(N.vG,{repoAddress:u.repoAddress,height:s,start:c,onToggle:i,onToggleAll:l,expanded:o.includes((0,eo.Uz)(u.repoAddress)),showLocation:d.has(u.repoAddress.name),rightElement:(0,r.jsx)(f.u,{content:1===u.jobCount?"1 job":"".concat(u.jobCount," jobs"),placement:"top",children:(0,r.jsx)(g.V,{children:u.jobCount})})},t):(0,r.jsx)(ee,{name:u.name,isJob:u.isJob,repoAddress:u.repoAddress,height:s,start:c},t)})})]})})};var el=t(907),ea=t(49455),ed=t(14648),ec=t(74548),eu=t(50027),ex=t(17867),ep=t(65822);let eh=["jobs","tags","codeLocations"],em=()=>{let{allRepos:e,visibleRepos:n,loading:t,data:o}=(0,x.useContext)(ex.C5),i=e.length,p=(0,x.useMemo)(()=>{let e=Object.values(o).filter(e=>"WorkspaceLocationEntry"===e.__typename),t=(0,ea.S)(n);return ej(e).filter(e=>{let{repoAddress:n}=e;return t.has((0,eo.Uz)(n))})},[o,n]),h=(0,x.useMemo)(()=>p.flatMap(e=>e.jobs),[p]),{state:f,setters:g}=m(eh),b=(0,x.useMemo)(()=>({...f,codeLocations:f.codeLocations.map(e=>{let{name:n,location:t}=e;return(0,ep.kQ)(n,t)})}),[f]),y=(0,eu.A)({codeLocations:b.codeLocations,setCodeLocations:g.setCodeLocations}),v=(0,ec.im)({name:"Job",icon:"job",allValues:(0,x.useMemo)(()=>h.map(e=>({key:e.name,value:e.name,match:[e.name]})),[h]),renderLabel:e=>{let{value:n}=e;return(0,r.jsxs)(s.x,{flex:{direction:"row",gap:4,alignItems:"center"},children:[(0,r.jsx)(l.JO,{name:"job"}),(0,r.jsx)(j.rd,{text:n})]})},getStringValue:e=>e,state:b.jobs,onStateChanged:(0,x.useCallback)(e=>{g.setJobs(Array.from(e))},[g])}),w=(0,x.useMemo)(()=>[y,v],[y,v]),{button:I,activeFiltersJsx:S}=(0,ed.m)({filters:w}),C=(0,x.useMemo)(()=>p.filter(e=>!b.codeLocations.length||b.codeLocations.includes(e.repoAddress)).map(e=>({...e,jobs:e.jobs.filter(e=>!b.jobs.length||!!b.jobs.includes(e.name))})).filter(e=>!!e.jobs.length),[p,b]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.x,{padding:{horizontal:24,vertical:8},flex:{direction:"row",alignItems:"center",justifyContent:"space-between",grow:0},border:"bottom",children:I}),S.length?(0,r.jsx)(s.x,{padding:{vertical:8,horizontal:24},border:"bottom",flex:{direction:"row",gap:8},children:S}):null,t&&!i?(0,r.jsx)(s.x,{padding:64,children:(0,r.jsx)(u.f,{label:"Loading jobs…"})}):t?(0,r.jsx)(s.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,r.jsxs)(s.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,r.jsx)(a.$,{purpose:"body-text"}),(0,r.jsx)("div",{style:{color:d.$()},children:"Loading jobs…"})]})}):C.length?(0,r.jsx)(ei,{repos:C}):(0,r.jsx)(s.x,{padding:{top:20},children:(0,r.jsx)(c.t,{icon:"search",title:"No jobs",description:p.length?"No jobs were found that match your filters":"No jobs were found in your definitions"})})]})},ej=e=>{let n=e.map(e=>e.locationOrLoadError),t=[];for(let e of n)if((null==e?void 0:e.__typename)==="RepositoryLocation")for(let n of e.repositories){let{name:r,pipelines:s}=n,o=(0,ep.kQ)(r,e.name),i=s.filter(e=>{let{name:n}=e;return!(0,p.pv)(n)});i.length>0&&t.push({repoAddress:o,jobs:i})}return(0,el.S)(t)};var ef=t(69737),eg=t(20171);let eb=()=>((0,ef.Px)(),(0,eg.j)("Jobs"),(0,r.jsxs)(s.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,r.jsx)(o.m,{title:(0,r.jsx)(i.X6,{children:"Jobs"})}),(0,r.jsx)(em,{})]}));var ey=eb},907:function(e,n,t){t.d(n,{S:function(){return s}});var r=t(22563);let s=e=>[...e].sort((e,n)=>{let t=(0,r.Uz)(e.repoAddress),s=(0,r.Uz)(n.repoAddress);return t.localeCompare(s)})},49455:function(e,n,t){t.d(n,{S:function(){return o}});var r=t(65822),s=t(22563);let o=e=>new Set(e.map(e=>(0,s.Uz)((0,r.kQ)(e.repository.name,e.repositoryLocation.name))))},84046:function(e,n,t){t.d(n,{JH:function(){return f},qL:function(){return g}});var r=t(52322),s=t(14934),o=t(55010),i=t(35292),l=t(39013),a=t(74188),d=t(47933),c=t(35505),u=t(54516),x=t(67994),p=t(59351),h=t(33182),m=t(90797);let j=e=>{let{status:n,opacity:t=1}=e,s=x.YM[n];return(0,r.jsx)(I,{$color:s,$opacity:t})},f=e=>{let{fade:n,jobName:t,runs:i}=e,l=i.length,a=.8/Math.max(3,l);return(0,r.jsx)(s.x,{flex:{direction:"row",alignItems:"center",gap:2},children:i.map((e,s)=>(0,r.jsx)(o.J,{position:"top",interactionKind:"hover",content:(0,r.jsx)("div",{children:(0,r.jsx)(g,{run:e,name:t})}),hoverOpenDelay:100,children:(0,r.jsx)(j,{runId:e.id,status:e.status,opacity:n?1-(l-s-1)*a:1},e.id)},e.id))})},g=e=>{let{name:n,run:t}=e;return(0,r.jsxs)(b,{children:[(0,r.jsx)(y,{children:n}),(0,r.jsxs)(v,{children:[(0,r.jsxs)(s.x,{flex:{alignItems:"center",direction:"row",gap:8},children:[(0,r.jsx)(u.K9,{status:t.status}),(0,r.jsx)(d.rU,{to:"/runs/".concat(t.id),children:(0,r.jsx)(i.aU,{children:(0,h.EI)(t)})})]}),(0,r.jsxs)(s.x,{flex:{direction:"column",gap:4},children:[(0,r.jsx)(h.Zr,{run:t}),(0,r.jsx)(h.Tw,{run:t})]})]}),p.hd.has(t.status)||p.Ys.has(t.status)?(0,r.jsx)(w,{children:(0,r.jsx)(m.I,{runId:t.id})}):null]})},b=c.ZP.div.withConfig({componentId:"sc-59d147fc-0"})(["padding:4px;font-size:12px;width:220px;"]),y=c.ZP.div.withConfig({componentId:"sc-59d147fc-1"})(["padding:8px;box-shadow:inset 0 -1px ",";font-family:",";font-size:14px;font-weight:500;color:",";max-width:100%;text-overflow:ellipsis;overflow:hidden;min-width:0px;"],l.wL(),a.b.default,l.Ep()),v=c.ZP.div.withConfig({componentId:"sc-59d147fc-2"})(["padding:8px;display:flex;align-items:flex-start;justify-content:space-between;"]),w=c.ZP.div.withConfig({componentId:"sc-59d147fc-3"})(["overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:4px 8px 8px;:empty{display:none;}"]),I=c.ZP.div.withConfig({componentId:"sc-59d147fc-4"})(["background-color:",";border-radius:2px;height:16px;opacity:",";width:8px;"],e=>{let{$color:n}=e;return n},e=>{let{$opacity:n}=e;return n})}}]);
//# sourceMappingURL=2329.e0e11f139398995a.js.map