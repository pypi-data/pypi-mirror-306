{"version":3,"file":"lib_widget_js-webpack_sharing_consume_default_jupyter-widgets_base.b002009605467ad38938.js","mappings":";;;;;;;;;;;;;;;;;;;;;AAAA,MAAM,UAAW,SAAQ,QAAQ;IAC/B,SAAS,CAAC,MAAc,EAAE,EAAU;QAClC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;YAC1B,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;SAC7C;IACH,CAAC;CACF;AAED,SAAS,oBAAoB,CAAC,SAAgB,EAAE,QAA4B;IAC1E,oGAAoG;IACpG,IAAI,QAAQ,CAAC,UAAU,KAAK,EAAE,EAAE;QAC9B,OAAO,CAAC,GAAG,CACT,wCAAwC,EACxC,+DAA+D,EAC/D,QAAQ,CACT,CAAC;KACH;IACD,4FAA4F;IAC5F,IAAI,QAAQ,CAAC,YAAY,KAAK,CAAC,EAAE;QAC/B,OAAO,CAAC,GAAG,CACT,yCAAyC,EACzC,uEAAuE,EACvE,QAAQ,CACT,CAAC;KACH;IAED,oBAAoB;IACpB,oFAAoF;IACpF,MAAM,eAAe,GAAG,QAAQ,CAAC,UAAU,IAAI,KAAK,CAAC,CAAC,iBAAiB;IACvE,MAAM,UAAU,GAAG,CAAC,CAAC,CAAC,yCAAyC;IAC/D,MAAM,eAAe,GAAG,EAAE,CAAC,CAAC,iDAAiD;IAC7E,MAAM,YAAY,GAAG,CAAC,UAAU,GAAG,eAAe,CAAC,GAAG,CAAC,CAAC,CAAC,eAAe;IACxE,MAAM,gBAAgB,GAAG,YAAY,GAAG,eAAe,CAAC,CAAC,uBAAuB;IAEhF,MAAM,gBAAgB,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;IACnE,MAAM,cAAc,GAAG,gBAAgB,GAAG,YAAY,CAAC;IAEvD,MAAM,WAAW,GAAG,IAAI,WAAW,CAAC,EAAE,GAAG,cAAc,CAAC,CAAC;IACzD,MAAM,EAAE,GAAG,IAAI,UAAU,CAAC,WAAW,CAAC,CAAC;IACvC,IAAI,MAAM,GAAG,CAAC,CAAC;IAEf,cAAc;IACd,EAAE,CAAC,SAAS,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;IAC7B,MAAM,IAAI,CAAC,CAAC;IACZ,EAAE,CAAC,SAAS,CAAC,MAAM,EAAE,cAAc,GAAG,EAAE,EAAE,IAAI,CAAC,CAAC;IAChD,MAAM,IAAI,CAAC,CAAC,CAAC,eAAe;IAC5B,EAAE,CAAC,SAAS,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;IAC7B,MAAM,IAAI,CAAC,CAAC;IAEZ,eAAe;IACf,EAAE,CAAC,SAAS,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;IAC7B,MAAM,IAAI,CAAC,CAAC;IACZ,EAAE,CAAC,SAAS,CAAC,MAAM,EAAE,EAAE,EAAE,IAAI,CAAC,CAAC;IAC/B,MAAM,IAAI,CAAC,CAAC,CAAC,YAAY;IACzB,EAAE,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC;IAC9B,MAAM,IAAI,CAAC,CAAC,CAAC,mBAAmB;IAChC,EAAE,CAAC,SAAS,CAAC,MAAM,EAAE,UAAU,EAAE,IAAI,CAAC,CAAC;IACvC,MAAM,IAAI,CAAC,CAAC,CAAC,kBAAkB;IAC/B,EAAE,CAAC,SAAS,CAAC,MAAM,EAAE,eAAe,EAAE,IAAI,CAAC,CAAC;IAC5C,MAAM,IAAI,CAAC,CAAC,CAAC,uBAAuB;IACpC,EAAE,CAAC,SAAS,CAAC,MAAM,EAAE,gBAAgB,EAAE,IAAI,CAAC,CAAC;IAC7C,MAAM,IAAI,CAAC,CAAC,CAAC,wBAAwB;IACrC,EAAE,CAAC,SAAS,CAAC,MAAM,EAAE,YAAY,EAAE,IAAI,CAAC,CAAC;IACzC,MAAM,IAAI,CAAC,CAAC,CAAC,oBAAoB;IACjC,EAAE,CAAC,SAAS,CAAC,MAAM,EAAE,eAAe,EAAE,IAAI,CAAC,CAAC;IAC5C,MAAM,IAAI,CAAC,CAAC,CAAC,uBAAuB;IACpC,8BAA8B;IAE9B,aAAa;IACb,EAAE,CAAC,SAAS,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;IAC7B,MAAM,IAAI,CAAC,CAAC;IACZ,EAAE,CAAC,SAAS,CAAC,MAAM,EAAE,cAAc,EAAE,IAAI,CAAC,CAAC;IAC3C,MAAM,IAAI,CAAC,CAAC;IAEZ,KAAK,MAAM,CAAC,IAAI,SAAS,EAAE;QACzB,EAAE,CAAC,QAAQ,CAAC,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,KAAK,CAAC,EAAE,IAAI,CAAC,CAAC;QACjD,MAAM,IAAI,CAAC,CAAC;KACb;IAED,OAAO,CAAC,GAAG,CACT,wBAAwB;QACtB,eAAe;QACf,YAAY;QACZ,gBAAgB;QAChB,YAAY,CACf,CAAC;IAEF,OAAO,IAAI,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,IAAI,EAAE,WAAW,EAAE,CAAC,CAAC;AAC/C,CAAC;AAED,MAAM,WAAW,GAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;uEA8BmD,CAAC;AAExE,wEAAwE;AACxE,IAAI,SAAS,CAAC,YAAY,EAAE;IAC1B,OAAO,CAAC,GAAG,CAAC,kCAAkC,CAAC,CAAC;CACjD;KAAM;IACL,OAAO,CAAC,GAAG,CAAC,uCAAuC,CAAC,CAAC;CACtD;AAED,IAAI,YAA0B,CAAC;AAC/B,IAAI,iBAAsB,CAAC,CAAC,mBAAmB;AAC/C,IAAI,WAAuC,CAAC;AAC5C,IAAI,WAA+B,CAAC;AAEpC,SAAe,2BAA2B,CACxC,UAAkB,EAClB,WAAmB;;QAEnB,IAAI,CAAC,YAAY,EAAE;YACjB,IAAI;gBACF,YAAY,GAAG,IAAI,YAAY,EAAE,CAAC;gBAClC,MAAM,YAAY,CAAC,OAAO,EAAE,CAAC,CAAC,gBAAgB;gBAE9C,MAAM,YAAY,CAAC,YAAY,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;gBACtD,iBAAiB,GAAG,IAAI,gBAAgB,CAAC,YAAY,EAAE,WAAW,CAAC,CAAC;gBACpE,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;aAC3B;YAAC,OAAO,CAAC,EAAE;gBACV,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;gBACf,OAAO,IAAI,CAAC;aACb;SACF;QACD,OAAO,iBAAiB,CAAC;IAC3B,CAAC;CAAA;AAED,SAAe,gBAAgB,CAAC,cAAmB,SAAS;;QAC1D,IAAI,CAAC,WAAW,EAAE;YAChB,IAAI;gBACF,IAAI,CAAC,WAAW,EAAE;oBAChB,WAAW,GAAG;wBACZ,KAAK,EAAE,KAAK;wBACZ,KAAK,EAAE;4BACL,YAAY,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,sCAAsC;4BACjE,UAAU,EAAE,EAAE,KAAK,EAAE,YAAY,CAAC,UAAU,EAAE;4BAC9C,UAAU,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE;4BACzB,eAAe,EAAE,KAAK;4BACtB,gBAAgB,EAAE,KAAK;4BACvB,gBAAgB,EAAE,KAAK;yBACxB;qBACF,CAAC;iBACH;gBACD,MAAM,MAAM,GAAG,MAAM,SAAS,CAAC,YAAY,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;gBACtE,WAAW,GAAG,MAAM,YAAY,CAAC,uBAAuB,CAAC,MAAM,CAAC,CAAC;gBACjE,WAAW,GAAG,MAAM,MAAM,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC;gBAC7D,iBAAiB;gBACjB,WAAW,CAAC,UAAU;oBACpB,WAAW,CAAC,UAAU,IAAI,YAAY,CAAC,UAAU,CAAC;gBACpD,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;gBACpB,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;aAC1B;YAAC,OAAO,CAAC,EAAE;gBACV,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;gBACf,OAAO,IAAI,CAAC;aACb;SACF;QACD,OAAO,WAAW,CAAC;IACrB,CAAC;CAAA;AAED,IAAI,OAAO,GAAU,EAAE,CAAC;AAEb,gBAAQ,GAAG,EAAE,CAAC;AAEzB,SAAsB,GAAG,CACvB,iBAAiB,GAAG,GAAG;;QAEvB,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QACnB,MAAM,IAAI,GAAG,IAAI,IAAI,CAAC,CAAC,WAAW,CAAC,EAAE,EAAE,IAAI,EAAE,wBAAwB,EAAE,CAAC,CAAC;QACzE,MAAM,2BAA2B,CAC/B,GAAG,CAAC,eAAe,CAAC,IAAI,CAAC,EACzB,0BAA0B,CAC3B,CAAC;QACF,OAAO,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC;QAE/B,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QACnB,MAAM,gBAAgB,EAAE,CAAC;QAEzB,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QACnB,MAAM,WAAW,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC;QAE7C,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QACnB,MAAM,YAAY,CAAC,MAAM,EAAE,CAAC;QAC5B,MAAM,UAAU,CAAC,GAAG,EAAE;YACpB,YAAY,CAAC,OAAO,EAAE,CAAC;QACzB,CAAC,EAAE,iBAAiB,CAAC,CAAC;QACtB,6FAA6F;QAC7F,yEAAyE;QAEzE,OAAO;IACT,CAAC;CAAA;AA1BD,kBA0BC;AAED,SAAgB,aAAa;IAC3B,OAAO,WAAW,CAAC,UAAU,IAAI,YAAY,CAAC,UAAU,CAAC;AAC3D,CAAC;AAFD,sCAEC;AAED,SAAgB,MAAM;IACpB,OAAO,GAAG,EAAE,CAAC;IACb,iBAAiB,CAAC,IAAI,CAAC,SAAS,GAAG,CAAC,CAAM,EAAE,EAAE;QAC5C,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;IACvB,CAAC,CAAC;IACF,YAAY,CAAC,MAAM,EAAE,CAAC;IACtB,iBAAiB,CAAC,UAAU;SACzB,GAAG,CAAC,aAAa,CAAC;SAClB,cAAc,CAAC,CAAC,EAAE,YAAY,CAAC,WAAW,CAAC,CAAC;IAC/C,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;AAC3B,CAAC;AAVD,wBAUC;AAED,SAAgB,OAAO;IACrB,YAAY,CAAC,OAAO,EAAE,CAAC;IACvB,iBAAiB,CAAC,UAAU;SACzB,GAAG,CAAC,aAAa,CAAC;SAClB,cAAc,CAAC,CAAC,EAAE,YAAY,CAAC,WAAW,CAAC,CAAC;IAC/C,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;IAEzB,MAAM,gBAAgB,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;IACnE,iBAAS,GAAG,IAAI,KAAK,CAAC,gBAAgB,CAAC,CAAC;IAExC,IAAI,MAAM,GAAG,CAAC,CAAC;IACf,KAAK,MAAM,MAAM,IAAI,OAAO,EAAE;QAC5B,KAAK,MAAM,KAAK,IAAI,MAAM,EAAE;YAC1B,iBAAS,CAAC,MAAM,EAAE,CAAC,GAAG,KAAK,CAAC;SAC7B;KACF;IAED,MAAM,IAAI,GAAG,oBAAoB,CAAC,iBAAS,EAAE,WAAW,CAAC,CAAC;IAC1D,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IAClB,gBAAQ,GAAG,GAAG,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;IACrC,uCAAuC;IACvC,oCAAoC;IACpC,wCAAwC;IACxC,0CAA0C;IAC1C,2DAA2D;IAC3D,wHAAwH;IACxH,UAAU;AACZ,CAAC;AA3BD,0BA2BC;;;;;;;;;;;;ACrQD,2BAA2B;AAC3B,2DAA2D;;;AAE3D,6DAA6D;AAC7D,aAAa;AACb,8DAA8D;AAC9D,MAAM,IAAI,GAAG,mBAAO,CAAC,uCAAiB,CAAC,CAAC;AAExC;;;;;GAKG;AACU,sBAAc,GAAG,IAAI,CAAC,OAAO,CAAC;AAE3C;;GAEG;AACU,mBAAW,GAAG,IAAI,CAAC,IAAI,CAAC;;;;;;;;;;;;ACnBrC,2BAA2B;AAC3B,2DAA2D;;;;;;;;;;;;;;;;;;;;;;AAE3D,8HAI+B;AAC/B,4IAEgC;AAEhC,2EAAwD;AAExD,6EAA6B;AAE7B,iBAAiB;AACjB,6BAA6B;AAE7B,MAAa,kBAAmB,SAAQ,qBAAc;IACpD,QAAQ;QACN,uCACK,KAAK,CAAC,QAAQ,EAAE,KACnB,WAAW,EAAE,kBAAkB,CAAC,UAAU,EAC1C,aAAa,EAAE,kBAAkB,CAAC,YAAY,EAC9C,qBAAqB,EAAE,kBAAkB,CAAC,oBAAoB,EAC9D,UAAU,EAAE,kBAAkB,CAAC,SAAS,EACxC,YAAY,EAAE,kBAAkB,CAAC,WAAW,EAC5C,oBAAoB,EAAE,kBAAkB,CAAC,mBAAmB,EAE5D,KAAK,EAAE,gBAAgB,EACvB,SAAS,EAAE,IAAI,YAAY,CAAC,CAAC,CAAC,EAC9B,QAAQ,EAAE,EAAE,EACZ,QAAQ,EAAE,aAAa,EACvB,MAAM,EAAE,iBAAiB,IACzB;IACJ,CAAC;;AAjBH,gDA8BC;AAXQ,8BAAW,mCACb,qBAAc,CAAC,WAAW,KAC7B,SAAS,EAAE,mDAAgC,IAC3C;AAEK,6BAAU,GAAG,oBAAoB,CAAC;AAClC,+BAAY,GAAG,qBAAW,CAAC;AAC3B,uCAAoB,GAAG,wBAAc,CAAC;AACtC,4BAAS,GAAG,mBAAmB,CAAC,CAAC,yBAAyB;AAC1D,8BAAW,GAAG,qBAAW,CAAC,CAAC,yBAAyB;AACpD,sCAAmB,GAAG,wBAAc,CAAC;AAG9C,MAAa,iBAAkB,SAAQ,oBAAa;IAMlD,MAAM;QACJ,IAAI,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC;QAEzC,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAC9C,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAEnC,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;QACpD,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,GAAG,CAC5B,iBAAiB,EACjB,gBAAgB,EAChB,eAAe,CAChB,CAAC;QACF,IAAI,CAAC,WAAW,CAAC,WAAW,GAAG,eAAe,CAAC;QAC/C,IAAI,CAAC,WAAW,CAAC,KAAK,GAAG,OAAO,CAAC;QACjC,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QAEtC,IAAI,CAAC,aAAa,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;QACtD,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,GAAG,CAC9B,iBAAiB,EACjB,gBAAgB,EAChB,eAAe,CAChB,CAAC;QACF,IAAI,CAAC,aAAa,CAAC,QAAQ,GAAG,IAAI,CAAC;QACnC,IAAI,CAAC,aAAa,CAAC,WAAW,GAAG,QAAQ,CAAC;QAC1C,IAAI,CAAC,aAAa,CAAC,KAAK,GAAG,UAAU,CAAC;QACtC,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QAExC,IAAI,CAAC,cAAc,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;QACvD,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,GAAG,CAC/B,iBAAiB,EACjB,gBAAgB,EAChB,eAAe,CAChB,CAAC;QACF,IAAI,CAAC,cAAc,CAAC,QAAQ,GAAG,IAAI,CAAC;QACpC,IAAI,CAAC,cAAc,CAAC,WAAW,GAAG,MAAM,CAAC;QACzC,IAAI,CAAC,cAAc,CAAC,KAAK,GAAG,WAAW,CAAC;QACxC,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;QAEzC,IAAI,CAAC,aAAa,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;QACrD,IAAI,CAAC,aAAa,CAAC,QAAQ,GAAG,IAAI,CAAC;QACnC,IAAI,CAAC,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QAExC,IAAI,CAAC,aAAa,EAAE,CAAC;QAErB,8BAA8B;QAC9B,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,cAAc,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;QACxD,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,YAAY,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;QAE/C,8BAA8B;QAC9B,IAAI,CAAC,WAAW,CAAC,OAAO,GAAG,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC9D,IAAI,CAAC,aAAa,CAAC,OAAO,GAAG,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAClE,IAAI,CAAC,cAAc,CAAC,OAAO,GAAG,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACtE,CAAC;IAEO,aAAa;QACnB,IAAI,CAAC,QAAQ,CAAC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;IACtD,CAAC;IAEO,MAAM,CAAC,OAAY,EAAE,OAAY;QACvC,QAAQ,OAAO,CAAC,GAAG,EAAE;YACnB,KAAK,KAAK;gBACR,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBAC1B,MAAM;YACR,KAAK,QAAQ;gBACX,IAAI,CAAC,oBAAoB,EAAE,CAAC;gBAC5B,MAAM;YACR,KAAK,SAAS;gBACZ,IAAI,CAAC,qBAAqB,EAAE,CAAC;gBAC7B,MAAM;SACT;IACH,CAAC;IAEO,kBAAkB;QACxB,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,OAAO,EAAE,6BAA6B,CAAC,CAAC;QACvD,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC;QACzC,IAAI,CAAC,KAAK,CAAC,YAAY,EAAE,CAAC;QAC1B,CAAC,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE;YACf,MAAM,WAAW,GAAG,CAAC,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC,CAAC;YAC9C,IAAI,CAAC,KAAK,CAAC,GAAG,CACZ,OAAO,EACP,yCAAyC;gBACvC,MAAM,CAAC,WAAW,CAAC;gBACnB,OAAO,CACV,CAAC;YACF,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;YAClC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,YAAY,EAAE,WAAW,CAAC,CAAC;YAC1C,IAAI,CAAC,KAAK,CAAC,YAAY,EAAE,CAAC;YAE1B,IAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,IAAI,CAAC;YACjC,IAAI,CAAC,aAAa,CAAC,QAAQ,GAAG,KAAK,CAAC;QACtC,CAAC,CAAC,CAAC;IACL,CAAC;IACO,oBAAoB;QAC1B,CAAC,CAAC,MAAM,EAAE,CAAC;QACX,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,CAAC,WAAW,GAAG,WAAW,CAAC,CAAC;QACjE,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,EAAE,WAAW,CAAC,CAAC;QACtC,IAAI,CAAC,KAAK,CAAC,YAAY,EAAE,CAAC;QAE1B,IAAI,CAAC,aAAa,CAAC,QAAQ,GAAG,IAAI,CAAC;QACnC,IAAI,CAAC,cAAc,CAAC,QAAQ,GAAG,KAAK,CAAC;IACvC,CAAC;IACO,qBAAqB;QAC3B,CAAC,CAAC,OAAO,EAAE,CAAC;QACZ,4BAA4B;QAC5B,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,WAAW,EAAE;YAC1B,KAAK,EAAE,IAAI,YAAY,CAAC,CAAC,CAAC,SAAS,CAAC;YACpC,KAAK,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC;SAC5B,CAAC,CAAC;QACH,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC;QACvC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,CAAC,WAAW,GAAG,YAAY,CAAC,CAAC;QAClE,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;QACrC,IAAI,CAAC,KAAK,CAAC,YAAY,EAAE,CAAC;QAE1B,IAAI,CAAC,aAAa,CAAC,GAAG,GAAG,CAAC,CAAC,QAAQ,CAAC;QACpC,IAAI,CAAC,aAAa,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;QACtD,IAAI,CAAC,aAAa,CAAC,QAAQ,GAAG,KAAK,CAAC;QACpC,IAAI,CAAC,cAAc,CAAC,QAAQ,GAAG,IAAI,CAAC;IACtC,CAAC;CACF;AA5HD,8CA4HC","sources":["webpack://@naoh16/ipyaudioworklet/./src/audio.ts","webpack://@naoh16/ipyaudioworklet/./src/version.ts","webpack://@naoh16/ipyaudioworklet/./src/widget.ts"],"sourcesContent":["class DataViewEx extends DataView {\n  setFourCC(offset: number, cc: string) {\n    for (let i = 0; i < 4; i++) {\n      this.setUint8(offset + i, cc.charCodeAt(i));\n    }\n  }\n}\n\nfunction encodeAudioAsWavfile(audiodata: any[], settings: MediaTrackSettings) {\n  // console.assert(settings.sampleSize == 16, \"sampleSize (Bit-per-sample) should be 16.\", settings);\n  if (settings.sampleSize !== 16) {\n    console.log(\n      'Warning: SampleSize is not 16 [bit].\\n',\n      'The sound is forcely quantized as int16 (signed short) sound.',\n      settings\n    );\n  }\n  //console.assert(settings.channelCount == 1, \"#Channel should be one (monoral).\", settings);\n  if (settings.channelCount !== 1) {\n    console.log(\n      'Warning: #Channel is not 1 (monoral).\\n',\n      'The sound is forcely converted to monaural sound by \"(L+R)/2\" method.',\n      settings\n    );\n  }\n\n  // see WAVEFORMAT_EX\n  // https://learn.microsoft.com/ja-jp/windows/win32/api/mmeapi/ns-mmeapi-waveformatex\n  const _nSamplesPerSec = settings.sampleRate || 48000; // ex. 48000 [Hz]\n  const _nChannels = 1; // settings.channelCount;   // ex. 1 [ch]\n  const _wBitsPerSample = 16; // settings.sampleSize || 16;     // ex. 16 [bit]\n  const _nBlockAlign = (_nChannels * _wBitsPerSample) / 8; // ex. 2 [byte]\n  const _nAvgBytesPerSec = _nBlockAlign * _nSamplesPerSec; // ex. 96000 [byte/sec]\n\n  const dataLengthSample = buffers.reduce((a, v) => a + v.length, 0);\n  const dataLengthByte = dataLengthSample * _nBlockAlign;\n\n  const arrayBuffer = new ArrayBuffer(44 + dataLengthByte);\n  const dv = new DataViewEx(arrayBuffer);\n  let offset = 0;\n\n  // RIFF Header\n  dv.setFourCC(offset, 'RIFF');\n  offset += 4;\n  dv.setUint32(offset, dataLengthByte + 36, true);\n  offset += 4; // filesize - 8\n  dv.setFourCC(offset, 'WAVE');\n  offset += 4;\n\n  // format chunk\n  dv.setFourCC(offset, 'fmt ');\n  offset += 4;\n  dv.setUint32(offset, 16, true);\n  offset += 4; // size = 16\n  dv.setUint16(offset, 1, true);\n  offset += 2; // WORD  wFormatTag\n  dv.setUint16(offset, _nChannels, true);\n  offset += 2; // WORD  nChannels\n  dv.setUint32(offset, _nSamplesPerSec, true);\n  offset += 4; // DWORD nSamplesPerSec\n  dv.setUint32(offset, _nAvgBytesPerSec, true);\n  offset += 4; // DWORD nAvgBytesPerSec\n  dv.setUint16(offset, _nBlockAlign, true);\n  offset += 2; // WORD  nBlockAlign\n  dv.setUint16(offset, _wBitsPerSample, true);\n  offset += 2; // WORD  wBitsPerSample\n  // PCM-format neglect 'cbSize'\n\n  // data chunk\n  dv.setFourCC(offset, 'data');\n  offset += 4;\n  dv.setUint32(offset, dataLengthByte, true);\n  offset += 4;\n\n  for (const v of audiodata) {\n    dv.setInt16(offset, Math.round(v * 32767), true);\n    offset += 2;\n  }\n\n  console.log(\n    'Info: sampling_rate = ' +\n      _nSamplesPerSec +\n      ' length = ' +\n      dataLengthSample +\n      ', [sample]'\n  );\n\n  return new Blob([dv], { type: 'audio/wav' });\n}\n\nconst procdef_str = `class AudioRecorderProcessor extends AudioWorkletProcessor\n{\n  constructor() {\n    super();\n  }\n\n  static get parameterDescriptors() {\n    return [\n      { name: \"isRecording\", defaultValue: 0 }\n    ];\n  }\n\n  process(inputs, outputs, params) {\n    if(!inputs[0][0]) return true;\n\n    if(params.isRecording[0] > 0) {\n      const firstInput = inputs[0];\n      const firstOutput = outputs[0];\n      const f2s_gain = 1. / firstInput.length;\n      for(let n=0; n<firstInput.length; n++) {\n        for(let m=0; m<firstInput[0].length; m++) {\n          firstOutput[0][m] += firstInput[n][m] * f2s_gain;\n        }\n      }\n      this.port.postMessage(firstOutput[0]);\n    }\n\n    return true;\n  }\n}\nregisterProcessor(\"audio-recorder-processor\", AudioRecorderProcessor);`;\n\n//const AudioContext = window.AudioContext || window.webkitAudioContext;\nif (navigator.mediaDevices) {\n  console.log('Info: getUserMedia is supported.');\n} else {\n  console.log('Error: getUserMedia is not supported.');\n}\n\nlet audioContext: AudioContext;\nlet audioRecorderNode: any; //AudioWorkletNode;\nlet audioSource: MediaStreamAudioSourceNode;\nlet mediaConfig: MediaTrackSettings;\n\nasync function prepareCustomAudioProcessor(\n  module_url: string,\n  module_name: string\n) {\n  if (!audioContext) {\n    try {\n      audioContext = new AudioContext();\n      await audioContext.suspend(); // or resume() ?\n\n      await audioContext.audioWorklet.addModule(module_url);\n      audioRecorderNode = new AudioWorkletNode(audioContext, module_name);\n      console.log(audioContext);\n    } catch (e) {\n      console.log(e);\n      return null;\n    }\n  }\n  return audioRecorderNode;\n}\n\nasync function readyAudioSource(constraints: any = undefined) {\n  if (!audioSource) {\n    try {\n      if (!constraints) {\n        constraints = {\n          video: false,\n          audio: {\n            channelCount: { ideal: 1 } /** channelCount will be ignored... */,\n            sampleRate: { ideal: audioContext.sampleRate },\n            sampleSize: { ideal: 16 },\n            autoGainControl: false,\n            echoCancellation: false,\n            noiseSuppression: false,\n          },\n        };\n      }\n      const stream = await navigator.mediaDevices.getUserMedia(constraints);\n      audioSource = await audioContext.createMediaStreamSource(stream);\n      mediaConfig = await stream.getAudioTracks()[0].getSettings();\n      // Fix sampleRate\n      mediaConfig.sampleRate =\n        mediaConfig.sampleRate || audioContext.sampleRate;\n      console.log(stream);\n      console.log(mediaConfig);\n    } catch (e) {\n      console.log(e);\n      return null;\n    }\n  }\n  return audioSource;\n}\n\nlet buffers: any[] = [];\nexport let audiodata: any[]; //new Float32Array(_audiodata);\nexport let blob_url = '';\n\nexport async function run(\n  annealing_time_ms = 500\n): Promise<void> {\n  console.log('(1)');\n  const blob = new Blob([procdef_str], { type: 'application/javascript' });\n  await prepareCustomAudioProcessor(\n    URL.createObjectURL(blob),\n    'audio-recorder-processor'\n  );\n  console.log(audioRecorderNode);\n\n  console.log('(2)');\n  await readyAudioSource();\n\n  console.log('(3)');\n  await audioSource.connect(audioRecorderNode);\n\n  console.log('(4)');\n  await audioContext.resume();\n  await setTimeout(() => {\n    audioContext.suspend();\n  }, annealing_time_ms);\n  // In general, most of the recording device could not record just after the device booted up.\n  // Short wait will be make better result for the first take of recording.\n\n  return;\n}\n\nexport function getSampleRate(): number | undefined {\n  return mediaConfig.sampleRate || audioContext.sampleRate;\n}\n\nexport function resume(): void {\n  buffers = [];\n  audioRecorderNode.port.onmessage = (e: any) => {\n    buffers.push(e.data);\n  };\n  audioContext.resume();\n  audioRecorderNode.parameters\n    .get('isRecording')\n    .setValueAtTime(1, audioContext.currentTime);\n  console.log('recording');\n}\n\nexport function suspend(): void {\n  audioContext.suspend();\n  audioRecorderNode.parameters\n    .get('isRecording')\n    .setValueAtTime(0, audioContext.currentTime);\n  console.log('suspended');\n\n  const dataLengthSample = buffers.reduce((a, v) => a + v.length, 0);\n  audiodata = new Array(dataLengthSample);\n\n  let offset = 0;\n  for (const buffer of buffers) {\n    for (const value of buffer) {\n      audiodata[offset++] = value;\n    }\n  }\n\n  const blob = encodeAudioAsWavfile(audiodata, mediaConfig);\n  console.log(blob);\n  blob_url = URL.createObjectURL(blob);\n  //       var reader = new FileReader();\n  //       reader.readAsDataURL(blob);\n  //       reader.onloadend = function() {\n  //         var base64data = reader.result;\n  //         const uiLog = document.querySelector('div#log');\n  //         uiLog.innerHTML += '<div style=\"width:100%; overflow-wrap: anywhere;\"><code>' + base64data + '</code></div>';\n  //       }\n}\n","// Copyright (c) Sunao Hara\n// Distributed under the terms of the Modified BSD License.\n\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\n// eslint-disable-next-line @typescript-eslint/no-var-requires\nconst data = require('../package.json');\n\n/**\n * The _model_module_version/_view_module_version this package implements.\n *\n * The html widget manager assumes that this is the same as the npm package\n * version number.\n */\nexport const MODULE_VERSION = data.version;\n\n/*\n * The current package name.\n */\nexport const MODULE_NAME = data.name;\n","// Copyright (c) Sunao Hara\n// Distributed under the terms of the Modified BSD License.\n\nimport {\n  DOMWidgetModel,\n  DOMWidgetView,\n  ISerializers,\n} from '@jupyter-widgets/base';\nimport {\n  simplearray_serialization,\n} from \"jupyter-dataserializers\"\n\nimport { MODULE_NAME, MODULE_VERSION } from './version';\n\nimport * as a from './audio';\n\n// Import the CSS\n//import '../css/widget.css';\n\nexport class AudioRecorderModel extends DOMWidgetModel {\n  defaults(): Backbone.ObjectHash {\n    return {\n      ...super.defaults(),\n      _model_name: AudioRecorderModel.model_name,\n      _model_module: AudioRecorderModel.model_module,\n      _model_module_version: AudioRecorderModel.model_module_version,\n      _view_name: AudioRecorderModel.view_name,\n      _view_module: AudioRecorderModel.view_module,\n      _view_module_version: AudioRecorderModel.view_module_version,\n\n      value: 'Audio Recorder',\n      audiodata: new Float32Array(0),\n      blob_url: '',\n      filename: 'default.wav',\n      status: 'NOT_INITIALIZED'\n    };\n  }\n\n  static serializers: ISerializers = {\n    ...DOMWidgetModel.serializers,\n    audiodata: simplearray_serialization as any\n  };\n\n  static model_name = 'AudioRecorderModel';\n  static model_module = MODULE_NAME;\n  static model_module_version = MODULE_VERSION;\n  static view_name = 'AudioRecorderView'; // Set to null if no view\n  static view_module = MODULE_NAME; // Set to null if no view\n  static view_module_version = MODULE_VERSION;\n}\n\nexport class AudioRecorderView extends DOMWidgetView {\n  private _audioControl: HTMLAudioElement;\n  private _message: HTMLDivElement;\n  private _bootButton: HTMLButtonElement;\n  private _resumeButton: HTMLButtonElement;\n  private _suspendButton: HTMLButtonElement;\n  render(): any {\n    this.el.classList.add('jupyter-widgets');\n\n    this._message = document.createElement('div');\n    this.el.appendChild(this._message);\n\n    this._bootButton = document.createElement('button');\n    this._bootButton.classList.add(\n      'jupyter-widgets',\n      'jupyter-button',\n      'widget-button'\n    );\n    this._bootButton.textContent = 'Boot RECORDER';\n    this._bootButton.title = 'run()';\n    this.el.appendChild(this._bootButton);\n\n    this._resumeButton = document.createElement('button');\n    this._resumeButton.classList.add(\n      'jupyter-widgets',\n      'jupyter-button',\n      'widget-button'\n    );\n    this._resumeButton.disabled = true;\n    this._resumeButton.textContent = 'Record';\n    this._resumeButton.title = 'resume()';\n    this.el.appendChild(this._resumeButton);\n\n    this._suspendButton = document.createElement('button');\n    this._suspendButton.classList.add(\n      'jupyter-widgets',\n      'jupyter-button',\n      'widget-button'\n    );\n    this._suspendButton.disabled = true;\n    this._suspendButton.textContent = 'Stop';\n    this._suspendButton.title = 'suspend()';\n    this.el.appendChild(this._suspendButton);\n\n    this._audioControl = document.createElement('audio');\n    this._audioControl.controls = true;\n    this.el.appendChild(this._audioControl);\n\n    this.value_changed();\n\n    // Python --> JavaScipt update\n    this.model.on('change:value', this.value_changed, this);\n    this.model.on('msg:custom', this.on_msg, this);\n\n    // JavaScipt --> Python update\n    this._bootButton.onclick = this._onClickBootButton.bind(this);\n    this._resumeButton.onclick = this._onClickResumeButton.bind(this);\n    this._suspendButton.onclick = this._onClickSuspendButton.bind(this);\n  }\n\n  private value_changed(): void {\n    this._message.textContent = this.model.get('value');\n  }\n\n  private on_msg(command: any, buffers: any) {\n    switch (command.cmd) {\n      case 'run':\n        this._onClickBootButton();\n        break;\n      case 'resume':\n        this._onClickResumeButton();\n        break;\n      case 'suspend':\n        this._onClickSuspendButton();\n        break;\n    }\n  }\n\n  private _onClickBootButton() {\n    this.model.set('value', 'AudioRecorder is booting...');\n    this.model.set('status', 'INITIALIZING');\n    this.model.save_changes();\n    a.run().then((r) => {\n        const _sampleRate = a.getSampleRate() || -1;\n      this.model.set(\n        'value',\n        'AudioRecorder is ready (Sampling rate: ' +\n          String(_sampleRate) +\n          ' Hz).'\n      );\n      this.model.set('status', 'READY');\n      this.model.set('sampleRate', _sampleRate);\n      this.model.save_changes();\n\n      this._bootButton.disabled = true;\n      this._resumeButton.disabled = false;\n    });\n  }\n  private _onClickResumeButton() {\n    a.resume();\n    this.model.set('value', this._message.textContent + ' [RESUME]');\n    this.model.set('status', 'RECORDING');\n    this.model.save_changes();\n\n    this._resumeButton.disabled = true;\n    this._suspendButton.disabled = false;\n  }\n  private _onClickSuspendButton() {\n    a.suspend();\n    // console.log(a.audiodata);\n    this.model.set('audiodata', {\n      array: new Float32Array(a.audiodata),\n      shape: [a.audiodata.length]\n    });\n    this.model.set('blob_url', a.blob_url);\n    this.model.set('value', this._message.textContent + ' [SUSPEND]');\n    this.model.set('status', 'RECORDED');\n    this.model.save_changes();\n\n    this._audioControl.src = a.blob_url;\n    this._audioControl.title = this.model.get('filename');\n    this._resumeButton.disabled = false;\n    this._suspendButton.disabled = true;\n  }\n}\n"],"names":[],"sourceRoot":""}