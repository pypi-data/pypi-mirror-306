"use strict";(self.webpackChunk_datalayer_core=self.webpackChunk_datalayer_core||[]).push([[3691],{63691:(e,t,s)=>{s.r(t),s.d(t,{ExerciseEdit:()=>h,default:()=>x});var r=s(74512),o=s(66029),n=s(99608),i=s(40809),a=s(23189),l=s(9750),c=s(53133),d=s(18440),u=s(69058);const h=()=>{const{accountHandle:e,spaceHandle:t,exerciseId:s}=(0,n.UO)();if(!s)return(0,r.jsx)(r.Fragment,{});const h=(0,c.aF)(),{kernelManager:x,defaultKernel:p}=(0,l.useJupyter)(),m=(0,u.qX)(),j=((0,u.Ae)(),(0,l.useOutputsStore)()),g=m.layout().organization,C=m.layout().space,f=(0,o.useMemo)((()=>p),[x]),{cloneExercise:b,getExercise:y,getSpaceDatasets:F,refreshExercise:k,refreshSpaceDatasets:T,updateExercise:v}=(0,c.YT)(),[w,S]=(0,o.useState)(F()),B=j.outputs?.get("exercise-pre")?.input,E=j.outputs?.get("exercise-solution")?.input,D=j.outputs?.get("exercise-question")?.input,L=j.outputs?.get("exercise-test")?.input,_=(0,i.useConfirm)(),[P,R]=(0,o.useState)(!1),$=(0,c.s0)(),{enqueueToast:z}=(0,c.pm)(),[A,I]=(0,o.useState)();(0,o.useEffect)((()=>{k(s).then((e=>{if(e.success){const e=y(s);e?(I(e),m.layout().setItem(e),q((t=>({...t,name:e.name,description:e.description,help:e.help})))):$("/")}}))}),[s]),(0,o.useEffect)((()=>{C&&T(C,g).then((e=>{e.success&&S(F())}))}),[C]);const[V,q]=(0,o.useState)({name:"",description:"",help:'Use the assignment operator "=" to create the variable "x".'}),[H,O]=(0,o.useState)({name:!1,description:!1,help:!0});(0,o.useEffect)((()=>{O({...H,name:V.name.length>2,description:V.description.length>2})}),[V]);const W=(0,o.useCallback)((async e=>{_({title:"Are you sure?",content:"Please confirm you want to clone this exercise in your private library."}).then((e=>{e&&b(s).then((e=>{e.success&&(z(e.message,{variant:"success"}),m.layout().triggerItemsRefresh(),$(`/${h?.handle}/library/exercises`))}))}))}),[_,A]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Pagehead,{children:(0,r.jsxs)(i.Box,{display:"flex",children:[(0,r.jsx)(i.Box,{flex:1,children:(0,r.jsx)(i.Heading,{sx:{fontSize:3},children:"Exercise editor"})}),(0,r.jsx)(i.Box,{children:(0,r.jsxs)(i.ButtonGroup,{children:[(0,r.jsx)(i.Button,{variant:"default",size:"small",onClick:()=>$(`/${e}/${t}/exercise/${A?.id}/take`),children:"Take this exercise"}),C&&(0,r.jsx)(i.Button,{variant:"default",size:"small",leadingVisual:a.jcu,onClick:W,children:"Clone"})]})})]})}),A&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i.Box,{children:[(0,r.jsxs)(i.Box,{sx:{label:{marginTop:2}},children:[(0,r.jsxs)(i.FormControl,{children:[(0,r.jsx)(i.FormControl.Label,{children:"Name"}),(0,r.jsx)(i.TextInput,{block:!0,value:V.name,onChange:e=>{q((t=>({...t,name:e.target.value})))}}),!H.name&&(0,r.jsx)(i.FormControl.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,r.jsxs)(i.FormControl,{children:[(0,r.jsx)(i.FormControl.Label,{children:"Description"}),(0,r.jsx)(i.Textarea,{block:!0,value:V.description,onChange:e=>{q((t=>({...t,description:e.target.value})))}}),!H.description&&(0,r.jsx)(i.FormControl.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,r.jsxs)(i.Box,{display:"grid",gridTemplateColumns:"1fr 1fr",gridGap:3,children:[(0,r.jsxs)(i.Box,{children:[(0,r.jsxs)(i.FormControl,{children:[(0,r.jsx)(i.FormControl.Label,{children:"Preliminary code"}),(0,r.jsx)(i.FormControl.Caption,{children:"This is the preliminary code that will be run before the exercise is taken."})]}),(0,r.jsx)(l.Output,{showEditor:!0,autoRun:!0,kernel:f,code:A.codePre,id:"exercise-pre"})]}),(0,r.jsxs)(i.Box,{children:[(0,r.jsxs)(i.FormControl,{children:[(0,r.jsx)(i.FormControl.Label,{children:"Datasets"}),(0,r.jsx)(i.FormControl.Caption,{children:"Select the datasets to be used in the prelimary code."})]}),(0,r.jsx)(i.ActionList,{showDividers:!0,role:"listbox","aria-label":"Select assignees",children:w.map((e=>(0,r.jsxs)(i.ActionList.Item,{role:"option",onClick:t=>{t.preventDefault(),j.setDataset("exercise-pre",e)},children:[(0,r.jsx)(i.ActionList.LeadingVisual,{children:(0,r.jsx)(a.VHe,{})}),e.name,(0,r.jsxs)(i.ActionList.Description,{children:[e.mimeType," ",(0,d.Aq)(e.description)]})]},e.id)))})]})]}),(0,r.jsxs)(i.FormControl,{children:[(0,r.jsx)(i.FormControl.Label,{children:"Solution Code"}),(0,r.jsx)(i.FormControl.Caption,{children:"This is the expected solution code. The student will never see this content."})]}),(0,r.jsx)(l.Output,{showEditor:!0,autoRun:!0,kernel:f,id:"exercise-solution",code:A.codeSolution}),(0,r.jsxs)(i.FormControl,{children:[(0,r.jsx)(i.FormControl.Label,{children:"Question code"}),(0,r.jsx)(i.FormControl.Caption,{children:"This the question code that will be shown to the student."})]}),(0,r.jsx)(l.Output,{showEditor:!0,autoRun:!1,kernel:f,id:"exercise-question",code:A.codeQuestion}),(0,r.jsx)(i.Box,{children:(0,r.jsxs)(i.FormControl,{children:[(0,r.jsx)(i.FormControl.Label,{children:"Help for the student"}),(0,r.jsx)(i.FormControl.Caption,{children:"This a help that will be shown to the student if he asks for it."}),(0,r.jsx)(i.Textarea,{block:!0,value:V.help,onChange:e=>{q((t=>({...t,help:e.target.value})))}}),!H.help&&(0,r.jsx)(i.FormControl.Validation,{variant:"error",children:"Hint must have more than 2 characters"})]})}),(0,r.jsxs)(i.FormControl,{children:[(0,r.jsx)(i.FormControl.Label,{children:"Test the Solution code"}),(0,r.jsxs)(i.FormControl.Caption,{children:["Write the test code that will be run on the student's code during the exercise. Please refer to the ",(0,r.jsx)(i.Link,{href:"https://nbgrader.readthedocs.io/en/latest/user_guide/autograding_resources.html",target:"_blank",children:"nbgrader"})," documentation."]})]}),(0,r.jsx)(l.Output,{showEditor:!0,autoRun:!1,disableRun:!0,kernel:f,id:"exercise-test",code:A.codeTest})]}),(0,r.jsx)(i.Text,{as:"p",color:"fg.onEmphasis",bg:"neutral.emphasis",p:2,children:'Validate you tests with this button. It will run the "Preliminary code", then will run the "Test code" on the "Solution code". When a student will take the exercise, the "Test code" will be run on the "Student code".'}),(0,r.jsx)(i.Button,{variant:"danger",leadingVisual:a.Zi2,sx:{marginTop:2,marginBottom:2},onClick:e=>{e.preventDefault(),j.setExecuteRequest("exercise-test",`\nsetup_state(stu_code = """${A.codePre}\n${D}""", sol_code = """${A.codePre}\n${E}""")\n${L}\n`)},children:"Test"}),(0,r.jsx)(i.Text,{as:"p",color:"fg.onEmphasis",bg:"neutral.emphasis",p:2,children:"Once you are confident with your test, you can create the exercise. Don't worry, you can still update it before making it public."}),(0,r.jsx)(i.Button,{variant:"primary",disabled:!H.name||!H.description,sx:{marginTop:2},onClick:async()=>{v({id:A?.id,name:V.name,description:V.description,help:V.help,codePre:B??"",codeSolution:E??"",codeQuestion:D??"",codeTest:L??""}).then((e=>{e.success&&(z("The exercise is successfully updated.",{variant:"success"}),m.layout().triggerItemsRefresh())}))},children:"Update exercise"})]}),(0,r.jsxs)(i.Box,{children:[(0,r.jsx)(i.Heading,{as:"h2",sx:{fontSize:4,fontWeight:"normal",color:"danger.fg",mb:2},children:"Danger zone"}),(0,r.jsxs)(i.Box,{sx:{border:"1px solid",borderColor:"danger.emphasis",borderRadius:2,p:3,display:"flex",alignItems:"center",justifyContent:"space-between",gap:3},children:[(0,r.jsxs)(i.Box,{sx:{display:"grid",gap:1},children:[(0,r.jsx)(i.Text,{sx:{fontSize:1,fontWeight:"bold",color:"danger.fg"},children:"Delete exercise"}),(0,r.jsx)(i.Text,{sx:{fontSize:1,color:"fg.muted"},children:"Are you sure you don't want to just upgrade your account?"})]}),(0,r.jsx)(i.Button,{variant:"danger",onClick:e=>R(!0),disabled:!0,children:"Delete exercise"})]})]})]})]})},x=h}}]);